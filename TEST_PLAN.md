## Тест-план для приложения «To-Do List API»

### 1. Введение (Introduction)
Цель документа — описать стратегию и объем тестирования веб-приложения «To-Do List API», реализованного на FastAPI с использованием SQLAlchemy и SQLite. Тестирование направлено на подтверждение реализации функциональных и нефункциональных требований, снижению рисков, а также формирование оснований для приемки.

Область тестирования охватывает REST API (`/tasks`, `/tasks/{id}`) и пользовательский интерфейс, доступный по `/` с подключаемыми статическими ресурсами (`/static`).

### 2. Объект тестирования (Test Items)
Краткое описание проекта:
- Backend: FastAPI (`src/main.py`, `src/api/Task.py`)
- Модель данных: SQLAlchemy `Task` (`src/models/Task.py`), БД SQLite (`todo.db`)
- Схемы обмена данными: Pydantic (`src/schemas/Task.py`)
- UI: Jinja2 шаблон `src/templates/index.html`, статика `src/static/*`
- Уведомления: `src/notifications.py` (фоновые задачи при старте)

Компоненты/эндпойнты:
- `POST /tasks` — создание задачи
- `GET /tasks` — список задач с фильтрами, сортировкой и пагинацией
- `GET /tasks/{task_id}` — получение задачи по идентификатору
- `PUT /tasks/{task_id}` — обновление полей задачи
- `DELETE /tasks/{task_id}` — удаление задачи
- `GET /` — отдача страницы с интерфейсом

Требуемые атрибуты качества:
- Функциональная корректность: корректная реализация CRUD, фильтров, сортировки, пагинации
- Надежность: обработка ошибок (404 при отсутствии записи), стабильность при типичных нагрузках
- Юзабилити (для UI): базовая отображаемость и работоспособность сценариев
- Производительность: приемлемое время ответа для запросов списка (≤ 300 мс локально для 100 записей)
- Безопасность: в рамках учебного проекта — корректная валидация входных данных
- Поддерживаемость: согласованность схем и моделей

### 3. Риски (Risk Issues)
- Риск неконсистентности между Pydantic-схемами и ORM-моделью
- Отсутствие явного поля created_at может влиять на корректность сортировки по "created"
- Потенциальные проблемы миграций БД (динамическое добавление колонок `due_time`, `notified_60`, `notified_5` на старте)
- Уведомления в фоне могут порождать гонки при одновременных изменениях задач
- Валидация типов параметров фильтрации/сортировки может приводить к 422 при неверных значениях

### 4. Аспекты тестирования (Features to be Tested)
Функциональные аспекты:
- Создание задачи: обязательность `title`, опциональность `description`, `due_time`
- Чтение списка задач с фильтрами: `completed`, `has_due`, `search`
- Сортировка: `sort_by` (id|title|due|created) и `order` (asc|desc)
- Пагинация: `limit`, `offset`
- Получение одной задачи: корректные 200/404
- Обновление задачи: изменение `title`, `description`, `due_time`, `completed`, `notified_60`, `notified_5`
- Удаление задачи: корректные 200/404
- Отдача корневой страницы `/` и статики `/static/*`

Нефункциональные аспекты:
- Производительность базовых операций
- Устойчивость к некорректным данным (негативные сценарии)
- Совместимость API-типов (валидность схем)

Вне области (не тестируется в рамках этого плана):
- Авторизация/аутентификация (отсутствует)
- Масштабирование и HA

### 5. Подходы к тестированию (Test Approach)
- Ручное тестирование с использованием файла запросов `test_main.http` (IDE) и/или cURL/HTTP-клиента
- Автоматизированные проверки API через Pytest (опционально, при расширении)
- Инспекция БД SQLite для проверки побочных эффектов
- Нагрузочные замеры локально (простые измерения времени ответа)

Инструменты: HTTP Client IDE, curl/Postman, браузер, SQLite viewer.

### 6. Представление результатов (Pass / Fail Criteria)
Единица отчетности: тест-кейс.

Критерии приемки:
- Все обязательные функциональные требования реализованы и проходят
- Критические дефекты (P0/P1) отсутствуют; P2 допускаются с обходами
- Ошибки 5xx отсутствуют в стандартных сценариях

Метрики:
- Количество пройденных/проваленных кейсов
- Доля дефектов по приоритетам
- Время ответа основных эндпойнтов

Профили данных:
- Пустая БД
- БД с 1–5 задачами
- БД с 100+ задачами (генеративно)

Примерный список тест-кейсов (позитивные/негативные):
1. POST /tasks — создать минимальную задачу (title только) — 201/200, тело корректно
2. POST /tasks — валидация: пустой title — 422
3. GET /tasks — без параметров — список, по умолчанию сортировка asc по id
4. GET /tasks — фильтр completed=true|false — корректная фильтрация
5. GET /tasks — фильтр has_due=true|false — корректная фильтрация по `due_time`
6. GET /tasks — search по `title` и `description` — работает LIKE
7. GET /tasks — сортировка по title asc/desc — корректный порядок
8. GET /tasks — сортировка по due asc/desc — корректный порядок
9. GET /tasks — пагинация limit/offset — корректная выборка
10. GET /tasks/{id} — существующая задача — 200
11. GET /tasks/{id} — несуществующая — 404
12. PUT /tasks/{id} — обновление всех изменяемых полей — изменения отражены
13. PUT /tasks/{id} — несуществующая — 404
14. DELETE /tasks/{id} — существующая — 200 и фактическое удаление
15. DELETE /tasks/{id} — несуществующая — 404
16. GET / — отдается HTML-шаблон (200, тип content-type text/html)
17. Негатив: `sort_by`=unknown — применяется значение по умолчанию
18. Негатив: `order`=unknown — используется asc (по умолчанию)
19. Негатив: limit<1 или >500 — 422
20. Негатив: offset<0 — 422

### 7. Выводы (Conclusion)
Данный план и критерии позволяют оценить реализацию функциональных и нефункциональных требований. Покрытие позитивных и негативных сценариев, а также базовые замеры производительности демонстрируют соответствие продукта ожиданиям учебного задания и обеспечивают основания для приемки.

Приложение A. Следы к SRS
- Функциональные требования: CRUD задач, фильтры, сортировка, пагинация, отображение главной страницы
- Нефункциональные требования: стабильность, корректные коды ошибок, базовая производительность и валидация


